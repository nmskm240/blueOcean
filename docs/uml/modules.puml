@startuml
title blueOcean モジュール構成図

skinparam packageStyle rectangle
skinparam componentStyle rectangle

package "blueOcean" {

  package "domain" {
    [domain.account]
    [domain.ohlcv]
    [domain.bot]
  }

  package "core" {
    [core.strategies]
  }

  package "shared" {
    [shared.registries]
  }

  package "infra" {
    package "database" {
      [db.entities]
      [db.repositories]
      [db.mapper]
    }

    [infra.fetchers]
    [infra.settings]
    [infra.logging]
    [infra.stores]
    [infra.factories]
    [infra.accessors]
  }

  package "application" {
    [app.accessors]
    [app.analyzers]
    [app.broker]
    [app.di]
    [app.dto]
    [app.factories]
    [app.feed]
    [app.mapper]
    [app.preprocessor]
    [app.services]
    [app.store]
    [app.usecases]
    [app.workers]
  }

  package "presentation" {
    [ui.app]
    [ui.layout]
    [ui.pages]
    [ui.widgets]
    [ui.states]
    [ui.scopes]
    [ui.notifiers]
    [ui.utils]
  }
}

' 依存関係（レイヤ間の方向） -------------------------------------------

[core.strategies] --> [domain.account]
[core.strategies] --> [domain.ohlcv]

[db.repositories] --> [db.entities]
[db.repositories] --> [domain.account]
[db.repositories] --> [domain.ohlcv]
[db.repositories] --> [domain.bot]

[infra.fetchers] --> [infra.stores]
[infra.stores] --> [db.repositories]

[app.feed] --> [infra.stores]
[app.feed] --> [core.strategies]

[app.broker] --> [app.feed]

[app.usecases] --> [core.strategies]
[app.usecases] --> [db.repositories]
[app.usecases] --> [app.feed]
[app.usecases] --> [app.broker]
[app.usecases] --> [app.analyzers]

[app.services] --> [app.workers]
[app.workers] --> [app.usecases]

[app.di] --> [app.usecases]
[app.di] --> [app.services]
[app.di] --> [app.workers]
[app.di] --> [app.factories]
[app.di] --> [app.accessors]
[app.di] --> [app.broker]
[app.di] --> [app.feed]
[app.di] --> [app.store]
[app.di] --> [db.repositories]

[ui.scopes] --> [app.di]
[ui.scopes] --> [app.accessors]

[ui.notifiers] --> [app.usecases]
[ui.notifiers] --> [app.dto]
[ui.notifiers] --> [ui.states]

[ui.pages] --> [ui.layout]
[ui.pages] --> [ui.widgets]
[ui.pages] --> [ui.scopes]
[ui.pages] --> [shared.registries]
[ui.pages] --> [domain.bot]

[ui.widgets] --> [ui.scopes]
[ui.widgets] --> [app.accessors]
[ui.widgets] --> [app.dto]
[ui.widgets] --> [shared.registries]
[ui.widgets] --> [domain.ohlcv]

[infra.logging] --> [db.repositories]

@enduml
